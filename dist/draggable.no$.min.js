!function(a,b){"object"==typeof exports?module.exports=b(require("$")):"function"==typeof define&&define.amd?define(["$"],b):a.Draggable=b(a.$)}(this,function(a){"use strict";function b(a,b){return function(){a.apply(b,arguments)}}function c(a){return parseInt(a,10)}function d(a){return j?a.currentStyle:getComputedStyle(a)}function e(a){return void 0!==a}function f(a){return a instanceof Node}function g(){}var h={grid:0,filterTarget:null,limit:{x:null,y:null},threshold:0,setCursor:!1,setPosition:!0,smoothDrag:!0,onDrag:g,onDragStart:g,onDragEnd:g},i="ontouchstart"in window||"DocumentTouch"in window&&document instanceof DocumentTouch,j="Microsoft Internet Explorer"===navigator.appName,k=a(document),l=function(c,d){var e=this,g=b(e.start,e),j=b(e.drag,e),k=b(e.stop,e);if(!f(c))throw new TypeError("Draggable expects argument 0 to be an Element");a.extend(e,{element:c,handlers:{start:i?{touchstart:g}:{mousedown:g},move:i?{touchmove:j,touchend:k}:{mousemove:j,mouseup:k}},options:a.extend({},h,d)}),e.initialize()};return a.extend(l.prototype,{dragEvent:{started:!1,x:0,y:0},initialize:function(){var a=this,b=a.element.style,c=a.options,d=a._dimensions={height:element.offsetHeight,left:element.offsetLeft,top:element.offsetTop,width:element.offsetWidth};c.setPosition&&(b.left=d.left+"px",b.top=d.top+"px",b.right="auto",b.bottom="auto",b.position="absolute"),c.setCursor&&(b.cursor="move"),k.on(a.handlers.start)},start:function(a){var b=this,c=b.getCursor(a),d=b.element;b.useTarget(a.target)&&(a.preventDefault(),b.dragEvent.oldZindex=d.style.zIndex,d.style.zIndex=1e4,b.setCursor(c),b.setPosition(),b.setZoom(),k.on(b.handlers.move))},drag:function(b){var c=this,d=c.dragEvent,e=c.element,f=c._cursor,g=c._dimensions,h=f.x,i=f.y,j=c.options,k=g.zoom,l=c.getCursor(b),m=j.threshold,n=(l.x-h)/k+g.left,o=(l.y-i)/k+g.top;!d.started&&m&&Math.abs(h-l.x)<m&&Math.abs(i-l.y)<m||(d.started||(j.onDragStart(e,h,i,b),a.extend(d,{original:{x:n,y:o},started:!0})),c.move(n,o)&&j.onDrag(e,n,o,b))},move:function(a,b){var c,d,f,g,h,i=this,j=i._dimensions,k=i.dragEvent,l=i.options,m=l.grid,n=l.limit,o=e(n),p=element.style;if(n instanceof Function){if(h=n(a,b,k.original.x,k.original.y),!h)return;a=h[0],b=h[1],c=d=f=g=1}else o&&null!==n.x?n.x[1]?(c=a>n.x[0],d=a+j.width<=n.x[1]):(a=n.x,c=d=1):c=d=1,o&&null!==n.y?n.y[1]?(f=b>n.y[0],g=b+j.height<=n.y[1]):(b=n.y,f=g=1):f=g=1;var q={x:c&&d?a:c?n.x[1]-j.width:0,y:f&&g?b:f?n.y[1]-j.height:0};return!l.smoothDrag&&m&&(q=i.round(q,m)),q.x!==k.x||q.y!==k.y?(k.x=q.x,k.y=q.y,p.left=q.x+"px",p.top=q.y+"px",!0):!1},stop:function(a){var b,c=this,d=c.dragEvent,e=c.element,f=c.options,g=f.grid;k.off(c.handlers.move),e.style.zIndex=d.oldZindex,f.smoothDrag&&g&&(b=c.round({x:d.x,y:d.y},g),c.move(b.x,b.y)),c.dragEvent.started&&f.onDragEnd(e,d.x,d.y,a),c.reset()},reset:function(){var a=this,b=a.dragEvent;b={started:!1,x:0,y:0}},round:function(a){var b=this.options.grid;return{x:b*Math.round(a.x/b),y:b*Math.round(a.y/b)}},getCursor:function(a){return{x:(i?a.targetTouches[0]:a).clientX,y:(i?a.targetTouches[0]:a).clientY}},setCursor:function(a){this._cursor=a},setPosition:function(){var b=this,d=b.element,e=d.style;a.extend(b._dimensions,{left:c(e.left)||d.offsetLeft,top:c(e.top)||d.offsetTop})},setZoom:function(){for(var a=this,b=a.element,c=1;b=b.offsetParent;){var e=d(b).zoom;if(e){c=e;break}}a._dimensions.zoom=c},useTarget:function(a){var b=this.options.filterTarget;return b instanceof Function?b(a):!0}}),l});